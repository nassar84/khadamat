@inherits LayoutComponentBase
@inject Khadamat.BlazorUI.State.AppState AppState
@inject NavigationManager Navigation
@implements IDisposable

<div class="mobile-app">
    <MobileHeader />
    <MobileSidebar />
    
    <main class="mobile-content">
        @Body
    </main>
    
    <MobileBottomNav />
</div>

<style>
    .mobile-app {
        display: flex;
        flex-direction: column;
        height: 100vh;
        width: 100vw;
        overflow: hidden;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    }

    .mobile-content {
        flex: 1;
        overflow-y: auto;
        overflow-x: hidden;
        -webkit-overflow-scrolling: touch;
        padding-bottom: 70px; /* Space for bottom nav */
    }

    /* Hide web-specific elements */
    .sidebar,
    .header,
    .footer,
    .category-marquee {
        display: none !important;
    }

    /* Mobile optimizations */
    * {
        -webkit-tap-highlight-color: transparent;
    }

    /* Smooth scrolling */
    html {
        scroll-behavior: smooth;
    }
</style>

@code {
    protected override void OnInitialized()
    {
        AppState.OnChange += OnStateChange;
        Console.WriteLine("ANTIGRAVITY_LOG: MobileLayout OnInitialized called");
    }

    private async void OnStateChange()
    {
        await InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        AppState.OnChange -= OnStateChange;
    }
}
