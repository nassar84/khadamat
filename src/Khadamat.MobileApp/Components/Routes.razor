@using Microsoft.AspNetCore.Components.Web
@using Khadamat.BlazorUI.Layout
@inject NavigationManager Navigation

<ErrorBoundary>
    <ChildContent>
        <CascadingAuthenticationState>
            <Router AppAssembly="@typeof(Khadamat.BlazorUI._Imports).Assembly" 
                    AdditionalAssemblies="@(new[] { typeof(MauiProgram).Assembly })">
                <Found Context="routeData">
                    <RouteView RouteData="@routeData" DefaultLayout="@typeof(MobileLayout)" />
                    <FocusOnNavigate RouteData="@routeData" Selector="h1" />
                </Found>
                <NotFound>
                    <LayoutView Layout="@typeof(MobileLayout)">
                        <div style="padding: 20px; text-align: center; margin-top: 100px;">
                            <i class="fa-solid fa-face-frown fa-5x text-muted mb-4"></i>
                            <h1 class="fw-bold">404</h1>
                            <p class="text-muted">عذراً، هذه الصفحة غير موجودة</p>
                            <button class="btn btn-primary rounded-pill px-5" @onclick='() => Navigation.NavigateTo("/")'>العودة للرئيسية</button>
                        </div>
                    </LayoutView>
                </NotFound>
            </Router>
        </CascadingAuthenticationState>
    </ChildContent>
    <ErrorContent>
        <div style="padding:40px; text-align:center; color:red; background:white; z-index:99999; position:fixed; top:0; left:0; width:100%; height:100%; overflow:auto;">
            <i class="fa-solid fa-triangle-exclamation fa-5x mb-4"></i>
            <h1 style="font-weight:bold">خطأ تقني</h1>
            <p>حدث خطأ غير متوقع في التطبيق.</p>
            <hr/>
            <div style="text-align:left; font-size: 11px; background: #f8f9fa; padding: 15px; border-radius: 10px;">
                <strong>Message:</strong> @context.Message
            </div>
            <button onclick="window.location.reload()" class="btn btn-danger mt-4 rounded-pill px-5">إعادة التشغيل</button>
        </div>
    </ErrorContent>
</ErrorBoundary>
