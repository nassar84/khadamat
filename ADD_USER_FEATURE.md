# إضافة مستخدم جديد - دليل الاستخدام

## التغييرات المنفذة

### 1. Backend (API)
تم إضافة endpoint جديد في `AdminController.cs`:
- **POST** `/api/v1/admin/users`
- يقبل `CreateUserDto` يحتوي على: الاسم الكامل، البريد الإلكتروني، كلمة المرور، والدور
- يتحقق من عدم تكرار البريد الإلكتروني
- فقط SuperAdmin يمكنه إنشاء مستخدمين بدور SuperAdmin
- يقوم بإنشاء المستخدم وتعيين الدور المطلوب

### 2. DTOs
تم إضافة `CreateUserDto` في `AuthDtos.cs`:
```csharp
public class CreateUserDto
{
    public string FullName { get; set; }
    public string Email { get; set; }
    public string Password { get; set; }
    public string Role { get; set; } = "User";
}
```

### 3. Frontend Services
تم تحديث `IAdminService` و `AdminService`:
- إضافة method `CreateUser(CreateUserDto dto)` 
- يرسل طلب POST للـ API ويعيد بيانات المستخدم الجديد

### 4. واجهة المستخدم
تم تحديث `UsersManagement.razor`:
- إضافة نموذج منبثق (Modal) لإضافة مستخدم جديد
- حقول الإدخال: الاسم الكامل، البريد الإلكتروني، كلمة المرور، الدور
- التحقق من صحة البيانات قبل الإرسال
- عرض رسائل الخطأ إذا فشلت العملية
- إضافة المستخدم الجديد للقائمة فوراً بعد النجاح

### 5. Bootstrap JavaScript
تم إضافة `bootstrap.bundle.min.js` في `index.html` لتفعيل القوائم المنسدلة (dropdowns)

## كيفية الاستخدام

1. افتح صفحة إدارة المستخدمين: `/admin/usersmanagement`
2. اضغط على زر "إضافة مستخدم" في أعلى الصفحة
3. املأ البيانات المطلوبة:
   - الاسم الكامل (مطلوب)
   - البريد الإلكتروني (مطلوب، يجب أن يكون فريداً)
   - كلمة المرور (مطلوبة، 6 أحرف على الأقل)
   - الدور الوظيفي (اختياري، افتراضياً: مستخدم)
4. اضغط "إضافة المستخدم"
5. سيظهر المستخدم الجديد في القائمة فوراً

## الأدوار المتاحة

- **مستخدم (User)**: دور افتراضي للمستخدمين العاديين
- **مدير نظام (SystemAdmin)**: يمكن لأي مدير إنشاءه
- **مدير خارق (SuperAdmin)**: فقط SuperAdmin يمكنه إنشاء هذا الدور

## معالجة الأخطاء

- إذا كان البريد الإلكتروني مستخدماً بالفعل، ستظهر رسالة: "البريد الإلكتروني مستخدم بالفعل"
- إذا كانت كلمة المرور أقل من 6 أحرف: "كلمة المرور يجب أن تكون 6 أحرف على الأقل"
- إذا كان أي حقل مطلوب فارغاً، ستظهر رسالة توضح الحقل المطلوب

## ملاحظات الأمان

- يتم التحقق من الصلاحيات على مستوى الـ API
- SystemAdmin لا يمكنه إنشاء SuperAdmin
- جميع كلمات المرور يتم تشفيرها تلقائياً بواسطة ASP.NET Identity
